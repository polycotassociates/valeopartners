--- views_data_export.module
+++ views_data_export.module
@@ -2,9 +2,17 @@
 
 /**
  * @file
- * Primary module hooks for Views Data Export module.
+ * The views data export allowing exporting data from views displays.
+ *
+ * The views data export module allows data to be exported from views displays.
  */
 
+use Drupal\Core\Access\AccessResult;
+use Drupal\Core\Entity\EntityInterface;
+use Drupal\Core\Session\AccountInterface;
+use Drupal\views\ViewExecutable;
+use Drupal\views\Plugin\views\query\QueryPluginBase;
+
 /**
  * Implements hook_theme().
  */
@@ -18,3 +26,37 @@ function views_data_export_theme() {
     ],
   ];
 }
+
+/**
+ * Implements hook_ENTITY_TYPE_access().
+ */
+function views_data_export_file_access(EntityInterface $entity, $operation, AccountInterface $account) {
+  /* @var $entity EntityInterface */
+  if ($operation == 'download') {
+    // Grant access to download the generate export if it was generated by the
+    // current user.
+    $pattern = '/\/\/views_data_export\/(?<uid>\d+)-\d+-.+\.csv$/';
+    preg_match($pattern, $entity->getFileUri(), $matches);
+    if (isset($matches['uid']) && $matches['uid'] == $account->id()) {
+      return AccessResult::allowed();
+    }
+  }
+}
+
+/**
+ * Implements hook_views_query_alter().
+ */
+function views_data_export_views_query_alter(ViewExecutable $view, QueryPluginBase $query) {
+  if ($view->getDisplay()->getPluginId() != 'data_export') {
+    return;
+  }
+
+  // Get facet source id from view display and alter search query because facet
+  // module doesn't alter data_export displays.
+  $facet_source = $view->getDisplay()->getOption('facet_settings');
+  if (isset($facet_source) && $facet_source !== 'none') {
+    $search_query = $query->getSearchApiQuery();
+    $facet_manager = \Drupal::service('facets.manager');
+    $facet_manager->alterQuery($search_query, $facet_source);
+  }
+}
